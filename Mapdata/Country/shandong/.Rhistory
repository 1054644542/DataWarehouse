#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey95",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",high="#C72E29",mid="white",guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",high="#C72E29",mid="white",guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
mean(shandong_district_map_data$BudgetScale)
?mean
median(na.omit(shandong_district_map_data$BudgetScale))
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",high="#C72E29",mid="white",midpoint=median(na.omit(shandong_district_map_data$BudgetScale)),guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient(low="#014D64",high="#C72E29",guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=median(na.omit(shandong_district_map_data$BudgetScale)),guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=median(na.omit(shandong_district_map_data$BudgetScale)))+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
?range
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
showtext.end()
dev.off()
CairoPNG(file="DistrictGDP&Budget.png",width=1200,height=640)
font.add("myfont", "msyh.ttc")
showtext.begin()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,8),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
showtext.end()
dev.off()
CairoPNG(file="DistrictGDP&Budget.png",width=1200,height=640)
font.add("myfont", "msyh.ttc")
showtext.begin()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
showtext.end()
dev.off()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=117, y=36, label="● 高（预算）", color= "#C72E29", size=8) +
annotate("text", x=117, y=35, label="● 低（预算）", color= "#014D64", size=8) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=37.3, label="● 高（预算）", color= "#C72E29", size=8) +
annotate("text", x=114.8, y=36.8, label="● 低（预算）", color= "#014D64", size=8) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=37.3, label="● 高（预算）", color= "#C72E29", size=6) +
annotate("text", x=114.8, y=36.8, label="● 低（预算）", color= "#014D64", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=38.3, label="● 高（预算）", color= "#C72E29", size=6) +
annotate("text", x=114.8, y=37.8, label="● 低（预算）", color= "#014D64", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
CairoPNG(file="DistrictGDP&Budget.png",width=1200,height=640)
font.add("myfont", "msyh.ttc")
showtext.begin()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=38.3, label="● 高（预算）", color= "#C72E29", size=6) +
annotate("text", x=114.8, y=38, label="● 低（预算）", color= "#014D64", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
showtext.end()
dev.off()
CairoPNG(file="DistrictGDP&Budget.png",width=1200,height=640)
font.add("myfont", "msyh.ttc")
showtext.begin()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=38.3, label="● 高（预算）", color= "#C72E29", size=6) +
annotate("text", x=114.8, y=38, label="● 低（预算）", color= "#014D64", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
showtext.end()
dev.off()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="white",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic")
range(na.omit(shandong_district_map_data$BudgetScale))/2
range(na.omit(shandong_district_map_data$BudgetScale))
display.brewer.pal(#C72E29)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="grey",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP规模&公共预算收入分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=38.3, label="● 高（预算）", color= "#C72E29", size=6) +
annotate("text", x=114.8, y=38, label="● 低（预算）", color= "#014D64", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)+
scale_fill_gradient2(low="#014D64",mid="grey",high="#C72E29",midpoint=range(na.omit(shandong_district_map_data$BudgetScale))/2,guide=FALSE)+
coord_map("polyconic")
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale,fill=BudgetScale),shape=21,col="grey60",alpha=.8)+
scale_size(range=c(1,12),guide=FALSE)
?range
range(shandong_district_map_data$BudgetScale,na.rm = FALSE)/2
range(shandong_district_map_data$BudgetScale)
range(na.omit(shandong_district_map_data$BudgetScale))/2
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale),shape=21,fill="transparent",col="#014D64")+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=BudgetScale),shape=21,fill="#C72E29",col="transparent",alpha=.6)+
scale_size(range=c(1,12),guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP增速&公共预算收入增速分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=38.3, label="○ GDP（增速）", color= "#014D64", size=6) +
annotate("text", x=114.8, y=38,   label="● 预算（预算）", color= "#C72E29", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
CairoPNG(file="DistrictPerGDPGrowth&BudgetGrodth.png",width=1200,height=640)
font.add("myfont", "msyh.ttc")
showtext.begin()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale),shape=21,fill="transparent",col="#014D64")+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=BudgetScale),shape=21,fill="#C72E29",col="transparent",alpha=.6)+
scale_size(range=c(1,10),guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP增速&公共预算收入增速分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=38.3, label="○ GDP（增速）", color= "#014D64", size=6) +
annotate("text", x=114.8, y=38,   label="● 预算（预算）", color= "#C72E29", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
showtext.end()
dev.off()
CairoPNG(file="DistrictPerGDPGrowth&BudgetGrodth.png",width=1200,height=640)
font.add("myfont", "msyh.ttc")
showtext.begin()
ggplot()+
geom_polygon(data=shandong_district_map_data,aes(x=long,y=lat,group=group),col="grey60",fill="white",size=.2)+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=GDPScale),shape=21,fill="transparent",col="#014D64")+
geom_point(data=shandong_district_data,aes(x=lon,y=lat,size=BudgetScale),shape=21,fill="#C72E29",col="transparent",alpha=.6)+
scale_size(range=c(1,12),guide=FALSE)+
coord_map("polyconic") +
labs(title="山东省各行政县（包含县级市）2016年GDP增速&公共预算收入增速分布",subtitle="单位：（亿元）",caption="数据来源：山东省发展与改革委员会")+
annotate("text", x=114.8, y=38.3, label="○ GDP（增速）", color= "#014D64", size=6) +
annotate("text", x=114.8, y=38,   label="● 预算（预算）", color= "#C72E29", size=6) +
theme(
title=element_text(family="myfont",size=18),
plot.title=element_text(size=24),
plot.subtitle=element_text(family="myfont",size=18),
#plot.caption=element_text(family="myfont",size=18),
panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.position = c(0.02,0.8),
plot.caption=element_text(hjust=0)
)
showtext.end()
dev.off()
